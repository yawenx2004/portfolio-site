<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>about me</title>
    <link rel="stylesheet" type="text/css" href="./style/style.css">
    <link rel="shortcut icon" type="image/png" href="./images/logo.png">
  </head>

  <body>
    <div class="container first-container" id="about-container">
        <div class="about-left">
          <div class="container" id="yawen-image"></div>
        </div>

        <div class="about-right">
          <div class="title">about me :)</div>
          <div class="paragraph">Hello! I used they/she pronouns; I exist and I like to eat berries.</div>
          <div class="paragraph">I currently work as a UI/UX mentor in the DALI Lab in Dartmouth College, and it's been lovely. In my spare time I'm learning to rollerblade, crochet, and read tarot.</div>
          <div class="paragraph">I think you should hire me as a developer because I learn really fast and I love implementing things and it is 3:48 a.m. and I really should be asleep but I'm making this thing because it's so fun. :(</div>
        </div>
    </div>

    <div class="container">
      <div class="title">this is the weather where i'm from—</div>
      <div class="grid-container" id="weather"></div>
    </div>

    <div class="spacer"></div>
    
    <script>
      // changes picture when we're at a certain scroll position
      function logScrollPosition() {
        var scrollPosition = window.scrollY;

        // console.log("Scroll position:", scrollPosition);
        if (scrollPosition > 120) {
          document.getElementById('yawen-image').style.backgroundImage='url(../images/not-yawen-image.png)';
        } else {
          document.getElementById('yawen-image').style.backgroundImage='';
        }
      }
      window.addEventListener("scroll", logScrollPosition);

      // i'd like weather from these cities
      const cities = [
        { name: 'Hanover, NH', lat: '43.700859', lon: '-72.289398' },
        { name: 'Livermore, CA', lat: '37.6819', lon: '-121.7685' },
        { name: 'Nanjing, China', lat: '32.0584', lon: '118.7965' },
      ];

      // fetch weather
      async function fetchLocalWeather(lat, lon) {
        const apiKey = '36b343d898c2753e10cd15e0b4de0d7a';
        const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}`);
        const data = await response.json();
        return data;
      }
    
      // display weather
      async function displayWeather() {
        const weatherContainer = document.getElementById('weather');
        
        // for each city
        for (const city of cities) {
          const weatherData = await fetchLocalWeather(city.lat, city.lon);
          const temperature = (weatherData.main.temp - 273.15).toFixed(2);
          const description = weatherData.weather[0].description;
          const icon = `https://openweathermap.org/img/wn/${weatherData.weather[0].icon}.png`;
    
          // build html doc for display
          const weatherElement = document.createElement('div');
          weatherElement.innerHTML = `
            <div class="grid">
              <img src="${icon}" alt="${description}" />
              <div class="title">${city.name}</div>
              <div class="paragraph">${temperature}°C // ${description}</div>
            </div>`;
          weatherContainer.appendChild(weatherElement);
        }
      }
    
      window.onload = displayWeather;
    </script>
  </body>
</html>